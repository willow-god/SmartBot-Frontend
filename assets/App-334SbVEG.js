import{r,j as e,B as g}from"./index-6uUUDMWa.js";import{R as v}from"./InboxOutlined-CeIqNLdp.js";import{S as y}from"./index-fJj7ETqQ.js";import{I as N}from"./index-MRVOvF65.js";import{U as b}from"./index-BwzhNZHn.js";import{s}from"./index-D_rdUX3l.js";import"./PurePanel-Bst78Rcv.js";import"./useVariants-BevnM8xs.js";import"./useLocale-CdvqxKGZ.js";import"./fade-CQEYnZHM.js";import"./useForceUpdate-C8SbLCJF.js";const{Dragger:S}=b,F=()=>{const[l,n]=r.useState([]),[t,m]=r.useState(""),[i,u]=r.useState(2e3),[f,p]=r.useState(!1),h=a=>{m(a)},x={name:"file",multiple:!1,beforeUpload:a=>(n([a]),!1),onRemove:()=>{n([])},onDrop(a){console.log("Dropped files",a.dataTransfer.files)}},j=async()=>{if(l.length===0||!t){s.error("请先选择文件和类别");return}p(!0);const a=new FormData;a.append("video",l[0]),a.append("category",t),a.append("interval",i);let o="";if(t==="car")o="http://localhost:5000/data-upload";else if(t==="person")o="http://localhost:5000/data-upload";else{s.error("类别错误"),p(!1);return}console.log("API_URL",o);try{const d=await(await fetch(o,{method:"POST",body:a})).json();d.status==="success"?s.success("上传成功，正在处理数据源，请在数据管理页面查看"):s.error(`上传失败: ${d.message}`)}catch(c){s.error("上传失败"),console.error("上传失败",c)}finally{p(!1),n([])}};return e.jsxs("div",{className:"upload-main",children:[e.jsx("div",{className:"upload-container",children:e.jsxs(S,{...x,fileList:l,children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(v,{})}),e.jsx("p",{className:"ant-upload-text",children:"点击或者拖动文件到此处进行上传"}),e.jsx("p",{className:"ant-upload-hint",children:"仅支持单文件上传，视频格式为mp4等常用数据格式"})]})}),e.jsxs("div",{className:"upload-button",children:[e.jsx(y,{defaultValue:"点击选择数据源",className:"upload-select",style:{width:"100%"},onChange:h,options:[{label:e.jsx("span",{children:"车辆数据"}),title:"car",options:[{label:e.jsx("span",{children:"上传车牌数据源"}),value:"car"}]},{label:e.jsx("span",{children:"人脸数据"}),title:"person",options:[{label:e.jsx("span",{children:"上传人脸数据源"}),value:"person"}]}]}),e.jsx(N,{className:"upload-input",addonBefore:"处理间隔",addonAfter:"毫秒(ms)",value:i,onChange:a=>u(Number(a.target.value))}),e.jsx(g,{className:"data-upload-button",type:"primary",onClick:j,loading:f,children:"点击上传数据源"})]})]})};export{F as default};
