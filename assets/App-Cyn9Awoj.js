import{r as a,j as e,B as m}from"./index-6uUUDMWa.js";import{a as c}from"./axios-B4uVmeYG.js";import{F as r}from"./index-Cab7-Lcc.js";import{s}from"./index-D_rdUX3l.js";import{F}from"./Table-BZO_dkXx.js";import{M as S}from"./index-RwOJGtCZ.js";import{I as d}from"./index-MRVOvF65.js";import{S as u}from"./index-fJj7ETqQ.js";import{S as v}from"./index-ChkSb_ha.js";import"./responsiveObserver-csC9s065.js";import"./useLocale-CdvqxKGZ.js";import"./addEventListener-DXr10HFA.js";import"./index-VNbzaYcY.js";import"./Dropdown-C_SlUWEt.js";import"./PurePanel-Bst78Rcv.js";import"./useForceUpdate-C8SbLCJF.js";import"./useVariants-BevnM8xs.js";import"./index-B3WT-xPw.js";import"./fade-CQEYnZHM.js";import"./gapSize-U1swVQyS.js";const{Option:p}=u,N=()=>{const[x,h]=a.useState([]),[j,i]=a.useState(!1),[f,y]=a.useState(null),[o]=r.useForm();a.useEffect(()=>{l()},[]);const l=async()=>{try{const t=await c.get("http://127.0.0.1:5000/get_users");h(t.data)}catch{s.error("获取数据失败")}},k=async t=>{try{await c.post("http://127.0.0.1:5000/delete_user",{id:t}),s.success("删除成功"),l()}catch{s.error("删除失败")}},I=t=>{y(t),o.setFieldsValue(t),i(!0)},b=async()=>{try{const t=await o.validateFields();await c.post("http://127.0.0.1:5000/update_user",{id:f.id,...t}),s.success("修改成功"),i(!1),l()}catch{s.error("修改失败")}},g=()=>{i(!1)},w=[{title:"ID",dataIndex:"id",key:"id"},{title:"昵称",dataIndex:"nickname",key:"nickname"},{title:"邮箱",dataIndex:"email",key:"email"},{title:"权限",dataIndex:"role",key:"role"},{title:"操作",key:"action",render:(t,n)=>e.jsxs(v,{size:"middle",children:[e.jsx(m,{type:"primary",onClick:()=>I(n),children:"修改"}),e.jsx(m,{type:"primary",danger:!0,onClick:()=>k(n.id),children:"删除"})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(F,{columns:w,dataSource:x,rowKey:"id"}),e.jsx(S,{title:"修改用户信息",open:j,onOk:b,onCancel:g,children:e.jsxs(r,{form:o,layout:"vertical",children:[e.jsx(r.Item,{name:"nickname",label:"昵称",rules:[{required:!0,message:"请输入昵称"}],children:e.jsx(d,{})}),e.jsx(r.Item,{name:"password",label:"密码",rules:[{required:!0,message:"请输入密码"}],children:e.jsx(d.Password,{})}),e.jsx(r.Item,{name:"email",label:"邮箱",rules:[{required:!0,message:"请输入邮箱"}],children:e.jsx(d,{})}),e.jsx(r.Item,{name:"role",label:"权限",rules:[{required:!0,message:"请选择权限"}],children:e.jsxs(u,{placeholder:"请选择权限",children:[e.jsx(p,{value:"admin",children:"Admin"}),e.jsx(p,{value:"user",children:"User"})]})})]})})]})};export{N as default};
